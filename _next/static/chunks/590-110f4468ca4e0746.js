(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[590],{24654:function(){},1657:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var n=r(75504),a=r(51367);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}},425:function(e,t,r){"use strict";r.d(t,{Bz8:function(){return K},t7X:function(){return O},wnt:function(){return D},KH8:function(){return B},p6t:function(){return b},uHv:function(){return I},kAw:function(){return k},Tzb:function(){return g},oiV:function(){return C},xAP:function(){return T},w2w:function(){return E},Ayu:function(){return m},RDe:function(){return A},qGn:function(){return z},EwT:function(){return v},Ij9:function(){return _},RGM:function(){return U}});var n=r(94642),a=r(20568);function o(e){return{fetcherOptions:{},queryOptions:{},queryKeyFn:i}}let i=e=>{let t=u(e)?e.path.split("/").filter(Boolean).map(t=>s(t,e.variables.pathParams)):e.path.split("/").filter(Boolean);return l(e)&&t.push(e.variables.queryParams),d(e)&&t.push(e.variables.body),t},s=(e,t)=>e.startsWith("{")&&e.endsWith("}")?t[e.slice(1,-1)]:e,u=e=>!!e.variables.pathParams,d=e=>!!e.variables.body,l=e=>!!e.variables.queryParams;async function c(e){let{url:t,method:r,body:n,headers:a,pathParams:o,queryParams:i,signal:s}=e;try{var u;let e={"Content-Type":"application/json",...a};e["Content-Type"].toLowerCase().includes("multipart/form-data")&&delete e["Content-Type"];let d=await window.fetch("".concat("https://hyperion-3.dev.eclair.ec-lyon.fr").concat(f(t,i,o)),{signal:s,method:r.toUpperCase(),body:n?n instanceof FormData?n:JSON.stringify(n):void 0,headers:e});if(!d.ok){let e;try{e=await d.json()}catch(t){e={status:"unknown",payload:t instanceof Error?"Unexpected error (".concat(t.message,")"):"Unexpected error"}}throw e}if(null===(u=d.headers.get("content-type"))||void 0===u?void 0:u.includes("json"))return await d.json();return await d.blob()}catch(e){throw{name:"unknown",message:e instanceof Error?"Network error (".concat(e.message,")"):"Network error",stack:e}}}let f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new URLSearchParams(t).toString();return n&&(n="?".concat(n)),e.replace(/\{\w*\}/g,e=>r[e.slice(1,-1)])+n},p=(e,t)=>c({url:"/users/me",method:"get",...e,signal:t}),m=(e,t)=>{let{fetcherOptions:r,queryOptions:a,queryKeyFn:i}=o(t);return n.a({queryKey:i({path:"/users/me",operationId:"readCurrentUserUsersMeGet",variables:e}),queryFn:t=>{let{signal:n}=t;return p({...r,...e},n)},...t,...a})},h=(e,t)=>c({url:"/raid/participants/{participantId}",method:"get",...e,signal:t}),g=(e,t)=>{let{fetcherOptions:r,queryOptions:a,queryKeyFn:i}=o(t);return n.a({queryKey:i({path:"/raid/participants/{participantId}",operationId:"getParticipantByIdRaidParticipantsParticipantIdGet",variables:e}),queryFn:t=>{let{signal:n}=t;return h({...r,...e},n)},...t,...a})},y=(e,t)=>c({url:"/raid/participants/{participantId}",method:"patch",...e,signal:t}),v=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>y({...t,...e}),...e})},x=(e,t)=>c({url:"/raid/participants",method:"post",...e,signal:t}),b=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>x({...t,...e}),...e})},w=(e,t)=>c({url:"/raid/teams",method:"get",...e,signal:t}),k=(e,t)=>{let{fetcherOptions:r,queryOptions:a,queryKeyFn:i}=o(t);return n.a({queryKey:i({path:"/raid/teams",operationId:"getAllTeamsRaidTeamsGet",variables:e}),queryFn:t=>{let{signal:n}=t;return w({...r,...e},n)},...t,...a})},N=(e,t)=>c({url:"/raid/teams",method:"post",...e,signal:t}),I=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>N({...t,...e}),...e})},j=(e,t)=>c({url:"/raid/participants/{participantId}/team",method:"get",...e,signal:t}),T=(e,t)=>{let{fetcherOptions:r,queryOptions:a,queryKeyFn:i}=o(t);return n.a({queryKey:i({path:"/raid/participants/{participantId}/team",operationId:"getTeamByParticipantIdRaidParticipantsParticipantIdTeamGet",variables:e}),queryFn:t=>{let{signal:n}=t;return j({...r,...e},n)},...t,...a})},R=(e,t)=>c({url:"/raid/teams/{teamId}",method:"get",...e,signal:t}),C=(e,t)=>{let{fetcherOptions:r,queryOptions:a,queryKeyFn:i}=o(t);return n.a({queryKey:i({path:"/raid/teams/{teamId}",operationId:"getTeamByIdRaidTeamsTeamIdGet",variables:e}),queryFn:t=>{let{signal:n}=t;return R({...r,...e},n)},...t,...a})},F=(e,t)=>c({url:"/raid/teams/{teamId}",method:"patch",...e,signal:t}),_=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>F({...t,...e}),...e})},q=(e,t)=>c({url:"/raid/participant/{participantId}/document",method:"post",...e,signal:t}),D=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>q({...t,...e}),...e})},S=(e,t)=>c({url:"/raid/document/{documentId}",method:"get",...e,signal:t}),A=(e,t)=>{let{fetcherOptions:r,queryOptions:a,queryKeyFn:i}=o(t);return n.a({queryKey:i({path:"/raid/document/{documentId}",operationId:"readDocumentRaidDocumentDocumentIdGet",variables:e}),queryFn:t=>{let{signal:n}=t;return S({...r,...e},n)},...t,...a})},P=(e,t)=>c({url:"/raid/document/{documentId}/validate",method:"post",...e,signal:t}),U=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>P({...t,...e}),...e})},V=(e,t)=>c({url:"/raid/security_file/",method:"post",...e,signal:t}),z=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>V({...t,...e}),...e})},J=(e,t)=>c({url:"/raid/participant/{participantId}/security_file",method:"post",...e,signal:t}),K=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>J({...t,...e}),...e})},L=(e,t)=>c({url:"/raid/participant/{participantId}/payment",method:"post",...e,signal:t}),O=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>L({...t,...e}),...e})},W=(e,t)=>c({url:"/raid/teams/{teamId}/invite",method:"post",...e,signal:t}),B=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>W({...t,...e}),...e})},G=(e,t)=>c({url:"/raid/teams/join/{token}",method:"post",...e,signal:t}),E=e=>{let{fetcherOptions:t}=o();return a.D({mutationFn:e=>G({...t,...e}),...e})}},575:function(e,t,r){"use strict";r.d(t,{d:function(){return u},z:function(){return d}});var n=r(57437),a=r(2265),o=r(59143),i=r(57742),s=r(1657);let u=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-red-700 text-destructive-foreground hover:bg-red-700/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:d=!1,...l}=e,c=d?o.g7:"button";return(0,n.jsx)(c,{className:(0,s.cn)(u({variant:a,size:i,className:r})),ref:t,...l})});d.displayName="Button"},15671:function(e,t,r){"use strict";r.d(t,{Ol:function(){return s},SZ:function(){return d},Zb:function(){return i},aY:function(){return l},eW:function(){return c},ll:function(){return u}});var n=r(57437),a=r(2265),o=r(1657);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let s=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...a})});s.displayName="CardHeader";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});u.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...a})});l.displayName="CardContent";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...a})});c.displayName="CardFooter"},50326:function(e,t,r){"use strict";r.d(t,{Ei:function(){return x},FF:function(){return y},Tu:function(){return g},aM:function(){return l},bC:function(){return v},sw:function(){return c},ue:function(){return h},yo:function(){return d}});var n=r(57437),a=r(2265),o=r(72936),i=r(57742),s=r(52235),u=r(1657);let d=o.fC,l=o.xz,c=o.x8,f=o.h_,p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(o.aV,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...a,ref:t})});p.displayName=o.aV.displayName;let m=(0,i.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",team:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-none"}},defaultVariants:{side:"right"}}),h=a.forwardRef((e,t)=>{let{side:r="right",className:a,children:i,...d}=e;return(0,n.jsxs)(f,{children:[(0,n.jsx)(p,{}),(0,n.jsxs)(o.VY,{ref:t,className:(0,u.cn)(m({side:r}),a),...d,children:[i,(0,n.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,n.jsx)(s.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=o.VY.displayName;let g=e=>{let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};g.displayName="SheetHeader";let y=e=>{let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,u.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};y.displayName="SheetFooter";let v=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(o.Dx,{ref:t,className:(0,u.cn)("text-lg font-semibold text-foreground",r),...a})});v.displayName=o.Dx.displayName;let x=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(o.dk,{ref:t,className:(0,u.cn)("text-sm text-muted-foreground",r),...a})});x.displayName=o.dk.displayName},77625:function(e,t,r){"use strict";r.d(t,{O:function(){return o}});var n=r(57437),a=r(1657);function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",t),...r})}},91806:function(e,t,r){"use strict";r.d(t,{s:function(){return d}});var n=r(57437),a=r(68855),o=r(29908),i=r(575),s=r(41328),u=r(65400);let d=()=>{let{logout:e}=(0,a.a)(),{setUser:t}=(0,s.L)(),{setParticipant:r}=(0,u.p)();return(0,n.jsxs)(i.z,{variant:"destructive",onClick:function(){t(void 0),r(void 0),e()},className:"w-full",children:[(0,n.jsx)(o.ApJ,{className:"mr-2 h-4 w-4"}),"Se d\xe9connecter"]})}},68855:function(e,t,r){"use strict";r.d(t,{a:function(){return x}});var n=r(2265),a=r(7908),o=r(13374),i=r(22020),s=r(65249);let u=(0,i.Ue)()((0,s.mW)((0,s.tJ)(e=>({token:null,refreshToken:null,userId:null,setToken:t=>{let r=t?JSON.parse(atob(t.split(".")[1])).sub:null;e({token:t,userId:r})},setRefreshToken:t=>{e({refreshToken:t})}}),{name:"token-storage"})));var d=r(47907),l=r(41328),c=r(65400),f=r(87456),p=r(94642),m=r(26484);let h="RaidRegistering",g="https://raid-registering.myecl.fr/login",y="https://hyperion-3.dev.eclair.ec-lyon.fr",v=["API"],x=()=>{let[e,t]=(0,n.useState)(!1),{token:r,setToken:i,refreshToken:s,setRefreshToken:x,userId:b}=u(),{resetUser:w}=(0,l.L)(),{resetParticipant:k}=(0,c.p)(),{resetInviteToken:N}=(0,f.u)(),[I,j]=(0,n.useState)(!1),T=(0,d.useRouter)(),{codeVerifier:R,setCodeVerifier:C,resetCodeVerifier:F}=(0,m.f)(),_=(0,n.useRef)(null);async function q(e){let t=new TextEncoder().encode(e);return await crypto.subtle.digest("SHA-256",t).then(e=>btoa(Array.from(new Uint8Array(e)).map(e=>String.fromCharCode(e)).join("")).replace(/\+/g,"-").replace(/\//g,"_"))}async function D(e){t(!0);let r=(0,o.stringify)(e);try{let e=await a.Z.post("".concat(y,"/auth/token"),r,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}});if(200!=e.status){t(!1);return}let n=e.data;t(!1),i(n.access_token),x(n.refresh_token)}catch(e){console.error(e),t(!1),V()}}async function S(){return(t(!0),console.log("refreshing tokens"),s)?(await D({grant_type:"refresh_token",client_id:h,refresh_token:s}),s):null}function A(){return!!r&&(r?JSON.parse(atob(r.split(".")[1])).exp:0)<Math.floor(Date.now()/1e3)-60}async function P(t,r){if(console.log("logging in",e),!R||e){console.error("Code verifier not set");return}await D({grant_type:"authorization_code",client_id:h,code:t,redirect_uri:g,code_verifier:R}),j(!0),r&&r(),F()}async function U(){t(!0);let e=function(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,a=crypto.getRandomValues(new Uint8Array(e)),o=0;o<e;o++)t+=r.charAt(Math.floor(a[o]/e*n));return t}(128);C(e);let r="".concat(y,"/auth/authorize?client_id=").concat(h,"&response_type=code&scope=").concat(v.join(" "),"&redirect_uri=").concat(g,"&code_challenge=").concat(await q(e),"&code_challenge_method=S256");window.location.href=r}function V(){i(null),x(null),j(!1),T.replace("/login"),w(),k(),N()}async function z(){return(console.log("getting token from storage"),e)?null:(t(!0),null!==r?A()?S():(t(!1),j(!0),console.log("is token queried",I)):(t(!1),T.replace("/login")),r)}return(0,p.a)({queryKey:["lookToRefreshToken"],queryFn:()=>(function(){console.log("looking to refresh token"),_.current&&clearTimeout(_.current),console.log("token",r?JSON.parse(atob(r.split(".")[1])).exp:0);let e=(r?JSON.parse(atob(r.split(".")[1])).exp:0)*1e3-Date.now()-6e4;return console.log("time to refresh token",e),e<=0?S():_.current=setTimeout(()=>{S(),_.current=null},e),r})(),retry:0,enabled:I}),(0,p.a)({queryKey:["getTokenFromStorage"],queryFn:()=>z(),retry:0,enabled:!I}),{getTokenFromRequest:U,isLoading:e,token:r,isTokenQueried:I,logout:V,userId:b,isTokenExpired:A,login:P}}},41391:function(e,t,r){"use strict";r.d(t,{a:function(){return i}});var n=r(425),a=r(41328),o=r(68855);let i=()=>{let{token:e,isTokenExpired:t}=(0,o.a)(),{user:r,setUser:i}=(0,a.L)(),{data:s,isLoading:u}=(0,n.Ayu)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:void 0===r&&!t(),retry:0});return void 0!==s&&void 0===r&&null!==e&&i(s),{me:r,isLoading:u,isAdmin:()=>{var e,t;return null!==(t=null==r?void 0:null===(e=r.groups)||void 0===e?void 0:e.some(e=>"b378b102-4979-4186-8630-d28fe460ee08"===e.id))&&void 0!==t&&t}}}},26484:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var n=r(22020),a=r(65249);let o=(0,n.Ue)()((0,a.mW)((0,a.tJ)(e=>({codeVerifier:void 0,setCodeVerifier:t=>{e({codeVerifier:t,isLoading:!0})},resetCodeVerifier:()=>{e({codeVerifier:void 0,isLoading:!1})},isLoading:!1}),{name:"raid-code-verifier-storage"})))},87456:function(e,t,r){"use strict";r.d(t,{u:function(){return o}});var n=r(22020),a=r(65249);let o=(0,n.Ue)()((0,a.mW)((0,a.tJ)(e=>({InviteToken:void 0,setInviteToken:t=>{e({inviteToken:t})},resetInviteToken:()=>{e({inviteToken:void 0})}}),{name:"raid-invite-token-storage"})))},65400:function(e,t,r){"use strict";r.d(t,{p:function(){return o}});var n=r(22020),a=r(65249);let o=(0,n.Ue)()((0,a.mW)((0,a.tJ)(e=>({participant:void 0,setParticipant:t=>{e({participant:t})},resetParticipant:()=>{e({participant:void 0})}}),{name:"raid-participant-storage"})))},41328:function(e,t,r){"use strict";r.d(t,{L:function(){return o}});var n=r(22020),a=r(65249);let o=(0,n.Ue)()((0,a.mW)((0,a.tJ)(e=>({user:void 0,setUser:t=>{e({user:t})},resetUser:()=>{e({user:void 0})}}),{name:"raid-user-storage"})))}}]);