(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{4654:function(){},1531:function(e,r,t){Promise.resolve().then(t.bind(t,711))},1657:function(e,r,t){"use strict";t.d(r,{cn:function(){return o}});var n=t(3167),a=t(1367);function o(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,n.W)(r))}},711:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return g}});var n=t(3827),a=t(4090),o=t(575),s=t(5671),i=t(2782),l=t(2647),c=t(9908),d=t(1657);let u=a.forwardRef((e,r)=>{let{className:t,type:o,...s}=e,[i,l]=a.useState(!1),u=()=>l(!i);return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:i?"text":"password",className:(0,d.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s}),(0,n.jsx)("div",{className:"absolute inset-y-0 right-0 flex cursor-pointer items-center pr-3 text-gray-400",children:i?(0,n.jsx)(c.Rbo,{className:"h-4 w-4",onClick:u}):(0,n.jsx)(c.MBb,{className:"h-4 w-4",onClick:u})})]})});u.displayName="Input";let f=e=>{let{text:r}=e;return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,n.jsx)("span",{className:"w-full border-t"})}),(0,n.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,n.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:r})})]})};f.displayName="TextSeparator";var p=t(2177),m=t(7269),x=t(7907),h=()=>{let{getTokenFromRequest:e,token:r,isTokenQueried:t,isLoading:a}=(0,m.a)(),s=(0,x.useRouter)();return t&&null!==r&&s.replace("/"),(0,n.jsx)(o.z,{variant:"outline",onClick:function(r){r.preventDefault(),e(window)},disabled:a,children:a?(0,n.jsx)(p.BGW,{className:"mr-2 h-4 w-4 animate-spin"}):"MyECL"})},g=()=>(0,n.jsx)("div",{className:"flex [&>div]:w-full h-screen",children:(0,n.jsxs)(s.Zb,{className:"rounded-xl border bg-card text-card-foreground shadow max-w-[700px] m-auto text-zinc-700",children:[(0,n.jsxs)(s.Ol,{children:[(0,n.jsx)(s.ll,{children:"Se connecter"}),(0,n.jsx)(s.SZ,{children:"Connectez-vous avec MyECL ou par mail"})]}),(0,n.jsx)(s.aY,{children:(0,n.jsx)("form",{children:(0,n.jsxs)("div",{className:"grid w-full items-center gap-4",children:[(0,n.jsx)(h,{}),(0,n.jsx)(f,{text:"Ou continuez par email"}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(l._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(i.I,{placeholder:"raid@exemple.com",id:"email"}),(0,n.jsx)("div",{className:"h-2"}),(0,n.jsx)(l._,{htmlFor:"password",children:"Mot de passe"}),(0,n.jsx)(u,{type:"password",hidden:!0})]}),(0,n.jsx)("div",{}),(0,n.jsx)(o.z,{className:"w-full",onClick:function(e){e.preventDefault(),console.log("The link was clicked.")},children:"Se connecter"})]})})}),(0,n.jsxs)(s.eW,{className:"flex flex-row justify-between",children:[(0,n.jsx)(o.z,{variant:"link",children:"Cr\xe9er un compte"}),(0,n.jsx)(o.z,{variant:"link",children:"Mot de passe oubli\xe9 ?"})]})]})})},575:function(e,r,t){"use strict";t.d(r,{d:function(){return l},z:function(){return c}});var n=t(3827),a=t(4090),o=t(9143),s=t(7742),i=t(1657);let l=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-red-700 text-destructive-foreground hover:bg-red-700/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,size:s,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(l({variant:a,size:s,className:t})),ref:r,...d})});c.displayName="Button"},5671:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return s},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var n=t(3827),a=t(4090),o=t(1657);let s=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});s.displayName="Card";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("h3",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("p",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,o.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},2782:function(e,r,t){"use strict";t.d(r,{I:function(){return s}});var n=t(3827),a=t(4090),o=t(1657);let s=a.forwardRef((e,r)=>{let{className:t,type:a,...s}=e;return(0,n.jsx)("input",{type:a,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s})});s.displayName="Input"},2647:function(e,r,t){"use strict";t.d(r,{_:function(){return c}});var n=t(3827),a=t(4090),o=t(4602),s=t(7742),i=t(1657);let l=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(o.f,{ref:r,className:(0,i.cn)(l(),t),...a})});c.displayName=o.f.displayName},7269:function(e,r,t){"use strict";t.d(r,{a:function(){return m}});var n=t(4090),a=t(7908),o=t(3374),s=t(4642),i=t(4505),l=t(7907),c=t(9079);let d="Titan",u=c.env.NEXT_PUBLIC_REDIRECT_URL||"https://myecl.fr/static.html",f="https://hyperion-7.dev.eclair.ec-lyon.fr",p=["API"],m=()=>{let[e,r]=(0,n.useState)(!1),{token:t,setToken:c,refreshToken:m,setRefreshToken:x}=(0,i.u)(),[h,g]=(0,n.useState)(!1),b=(0,l.useRouter)();async function v(e){let r=new TextEncoder().encode(e);return await crypto.subtle.digest("SHA-256",r).then(e=>btoa(Array.from(new Uint8Array(e)).map(e=>String.fromCharCode(e)).join("")).replace(/\+/g,"-").replace(/\//g,"_"))}async function y(e){let t=(0,o.stringify)(e),n=await a.Z.post("".concat(f,"/auth/token"),t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}});if(200!=n.status){r(!1);return}let s=n.data;r(!1),c(s.access_token),x(s.refresh_token)}async function w(){return(console.log("refreshing tokens"),m)?(await y({grant_type:"refresh_token",client_id:d,refresh_token:m}),m):null}function j(){return!!t&&(t?JSON.parse(atob(t.split(".")[1])).exp:0)<Math.floor(Date.now()/1e3)}async function N(e){let t=function(e){for(var r="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length,a=crypto.getRandomValues(new Uint8Array(e)),o=0;o<e;o++)r+=t.charAt(Math.floor(a[o]/e*n));return r}(128),n="".concat(f,"/auth/authorize?client_id=").concat(d,"&response_type=code&scope=").concat(p.join(" "),"&redirect_uri=").concat(u,"&code_challenge=").concat(await v(t),"&code_challenge_method=S256");r(!0);let a=window.outerHeight/2+window.screenY-450,o=window.outerWidth/2+window.screenX-400;e=window.open(n,"Hyperion","height=".concat(900,",width=").concat(800,",top=").concat(a,",left=").concat(o,",scrollbars=yes"));let s=setInterval(()=>{try{e&&e.closed&&(clearInterval(s),r(!1))}catch(e){console.error(e)}},1e3);window.addEventListener("message",r=>{let n=r.data;null!=n&&n.includes("code=")&&function(r){let n=new URL(r).searchParams.get("code");e&&(e.close(),e=null),y({grant_type:"authorization_code",client_id:d,code:n,redirect_uri:u,code_verifier:t})}(n)})}async function k(){return r(!0),null!==t?j()?w():(c(t),r(!1)):(r(!1),b.replace("/login")),g(!0),t}return(0,s.a)({queryKey:["getTokenFromStorage"],queryFn:k,retry:0}),(0,s.a)({queryKey:["refreshToken"],queryFn:w,retry:0,enabled:j()}),{getTokenFromRequest:N,isLoading:e,token:t,isTokenQueried:h,logout:function(){c(null),x(null),g(!0),b.replace("/login")}}}},4505:function(e,r,t){"use strict";t.d(r,{u:function(){return o}});var n=t(2020),a=t(5249);let o=(0,n.Ue)()((0,a.mW)((0,a.tJ)(e=>({token:null,refreshToken:null,userId:null,setToken:r=>{let t=r?JSON.parse(atob(r.split(".")[1])).sub:null;e({token:r,userId:t})},setRefreshToken:r=>{e({refreshToken:r})}}),{name:"token-storage"})))}},function(e){e.O(0,[310,422,470,904,971,69,744],function(){return e(e.s=1531)}),_N_E=e.O()}]);