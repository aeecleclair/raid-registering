(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{18916:function(e,a,l){Promise.resolve().then(l.bind(l,33295))},33295:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return B}});var s=l(57437),i=l(26477),n=l(85115),t=l(87138),r=l(37164),d=l(21657),c=l(30338),o=l(11240),u=l(89733),h=l(48185),m=l(47304),v=l(2183),x=l(16463),f=l(26142),p=l(31590),j=l(84980),g=l(40133);let b=()=>{let{token:e}=(0,g.a)(),{refetch:a,isLoading:l}=(0,j.rVt)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:!1,retry:0});return{isLoading:l,refetchTeamFiles:a}},N=()=>{let{token:e}=(0,g.a)(),{refetch:a,isLoading:l}=(0,j.YJn)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:!1,retry:0});return{isLoading:l,refetchSecurityFiles:a}},_=e=>{var a;let{teams:l,isLoading:i}=e;function n(e,a){let l=new Date,s=e=>e.toString().padStart(2,"0"),i="".concat(l.getFullYear(),"-").concat(s(l.getMonth()+1),"-").concat(s(l.getDate()),"_").concat(s(l.getHours()),"_").concat(s(l.getMinutes()),"_").concat(s(l.getSeconds())),n=window.URL.createObjectURL(e),t=document.createElement("a");t.href=n,t.download="".concat(a,"_").concat(i,".zip"),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(n)}let j=(0,x.useRouter)(),g=(0,x.useSearchParams)(),{refetchTeamFiles:_,isLoading:S}=b(),{refetchSecurityFiles:k,isLoading:w}=N();return(0,s.jsxs)(h.Zb,{className:"xl:col-span-2",children:[(0,s.jsxs)(h.Ol,{className:"flex flex-row items-center",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(h.ll,{children:"Equipes"}),(0,s.jsxs)(h.SZ,{children:["Aper\xe7u des ",null!==(a=null==l?void 0:l.slice(0,5).length)&&void 0!==a?a:0," \xe9quipes les plus proches de la validation de leur dossier"]})]}),(0,s.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,s.jsxs)(p.h_,{children:[(0,s.jsx)(p.$F,{asChild:!0,children:(0,s.jsxs)(u.z,{size:"sm",variant:"outline",className:"gap-1",children:[(0,s.jsx)(r.Z,{className:"h-4 w-4 mr-1"}),"Documents"]})}),(0,s.jsxs)(p.AW,{align:"end",children:[(0,s.jsxs)(p.Xi,{disabled:S,onClick:()=>{_().then(e=>{let a=e.data;a instanceof Blob&&n(a,"Dossiers_Equipes")})},children:[(0,s.jsx)(o.Z,{className:"mr-2 h-4 w-4 "}),"Fichiers \xe9quipes"]}),(0,s.jsxs)(p.Xi,{disabled:w,onClick:()=>{k().then(e=>{let a=e.data;a instanceof Blob&&n(a,"Fiches_S\xe9curit\xe9s")})},children:[(0,s.jsx)(d.Z,{className:"mr-2 h-4 w-4 "}),"Fiches s\xe9curit\xe9"]})]})]}),(0,s.jsx)(u.z,{asChild:!0,size:"sm",className:"gap-1",children:(0,s.jsxs)(t.default,{href:"/admin/teams",children:["Voir tout",(0,s.jsx)(c.Z,{className:"h-4 w-4"})]})})]})]}),(0,s.jsx)(h.aY,{children:(0,s.jsxs)(m.iA,{children:[(0,s.jsx)(m.xD,{children:(0,s.jsxs)(m.SC,{children:[(0,s.jsx)(m.ss,{children:"Nom"}),(0,s.jsx)(m.ss,{className:"max-md:hidden",children:"Capitaine"}),(0,s.jsx)(m.ss,{className:"max-md:hidden",children:"Co\xe9quipier"}),(0,s.jsx)(m.ss,{className:"max-md:hidden",children:"Documents"}),(0,s.jsx)(m.ss,{className:"text-right",children:"Inscription"})]})}),(0,s.jsxs)(m.RM,{children:[i&&(0,s.jsx)(s.Fragment,{children:[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsxs)(m.SC,{children:[(0,s.jsx)(m.pj,{className:"h-[78px]",children:(0,s.jsx)(v.O,{className:"h-6 w-24"})}),[void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(m.pj,{className:"max-md:hidden",children:(0,s.jsx)(v.O,{className:"h-6 w-24"})},a)),(0,s.jsx)(m.pj,{children:(0,s.jsx)(v.O,{className:"h-6 w-8 ml-auto"})})]},a))}),l&&(0,s.jsx)(s.Fragment,{children:l.toSorted((e,a)=>a.validation_progress%100-e.validation_progress%100).slice(0,5).map(e=>{var a,l,i,n,t,r;let d=e.captain.number_of_validated_document+(null!==(t=null===(a=e.second)||void 0===a?void 0:a.number_of_validated_document)&&void 0!==t?t:0),c=e.captain.number_of_document+(null!==(r=null===(l=e.second)||void 0===l?void 0:l.number_of_document)&&void 0!==r?r:0);return(0,s.jsxs)(m.SC,{onClick:()=>(function(e){let a=new URLSearchParams(Array.from(g.entries()));a.set("teamId",e);let l=a.toString();j.replace("/admin/teams?".concat(l))})(e.id),children:[(0,s.jsx)(m.pj,{className:"h-[78px]",children:e.name}),(0,s.jsx)(m.pj,{className:"max-md:hidden",children:(0,s.jsxs)("div",{className:"font-medium",children:[null===(i=e.captain)||void 0===i?void 0:i.firstname," ",null===(n=e.captain)||void 0===n?void 0:n.name]})}),(0,s.jsx)(m.pj,{className:"max-md:hidden",children:e.second?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"font-medium",children:[e.second.firstname," ",e.second.name]})}):(0,s.jsx)("div",{className:"font-medium text-muted-foreground",children:"Non renseign\xe9"})}),(0,s.jsx)(m.pj,{className:"max-md:hidden",children:(0,s.jsx)(f.r,{progress:d,total:c})}),(0,s.jsxs)(m.pj,{className:"text-right",children:[null==e?void 0:e.validation_progress.toFixed(0),"%"]})]},e.id)})})]})]})})]})};var S=l(35231),k=l(83799),w=l(14725),y=l(68295),L=l(79512);let C={cssVars:{light:{primary:"240 5.9% 10%"},dark:{primary:"0 0% 98%"}}},z=e=>{let{data:a}=e,{theme:l}=(0,L.F)();return(0,s.jsxs)("div",{children:[(0,s.jsx)(S.h,{className:"min-h-40 md:min-h-80",children:(0,s.jsx)(k.v,{data:a,children:(0,s.jsx)(w.$,{dataKey:"value",radius:[10,10,0,0],style:{fill:"hsl(".concat(null==C?void 0:C.cssVars["dark"===l?"dark":"light"].primary,")"),opacity:1},children:a.map((e,a)=>(0,s.jsx)(y.b,{},"cell-".concat(a+1)))})})}),(0,s.jsx)("div",{className:"flex flex-row mt-1",children:a.map((e,a)=>(0,s.jsxs)("div",{className:"flex flex-col w-full",children:[(0,s.jsx)("span",{className:"text-center font-semibold",children:e.label}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground w-full text-center",children:e.value})]},"cell-".concat(a+1)))})]})};var P=l(86864),D=l(2265),E=l(9646),O=l(37440);let A=D.forwardRef((e,a)=>{let{className:l,...i}=e;return(0,s.jsx)(E.fC,{className:(0,O.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",l),...i,ref:a,children:(0,s.jsx)(E.bU,{className:(0,O.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});A.displayName=E.fC.displayName;var F=l(77504);let q=e=>{let{teams:a,isLoading:l}=e,[i,n]=(0,D.useState)(!1),{difficultyData:t,meetingPlaceData:r,bikeSizeData:d,tShirtSizeData:c,situationData:o}=function(e,a){var l,s,i,n,t;let r=null==a?void 0:a.filter(a=>100===a.validation_progress||e),d=(l=[{value:0,label:"D\xe9couverte"},{value:0,label:"Sportif"},{value:0,label:"Expert"}],e&&l.push({value:0,label:"Non renseign\xe9"}),r&&r.forEach(a=>{"discovery"===a.difficulty?l[0].value++:"sports"===a.difficulty?l[1].value++:"expert"===a.difficulty?l[2].value++:e&&l[3].value++}),l),c=(s=[{value:0,label:"Centrale Lyon"},{value:0,label:"Bellecour"},{value:0,label:"Peu importe"}],e&&s.push({value:0,label:"Non renseign\xe9"}),r&&r.forEach(a=>{switch(a.meeting_place){case"centrale":s[0].value++;break;case"bellecour":s[1].value++;break;case"anyway":s[2].value++;break;default:e&&s[3].value++}}),s);return{difficultyData:d,meetingPlaceData:c,bikeSizeData:(i=[{value:0,label:"XS"},{value:0,label:"S"},{value:0,label:"M"},{value:0,label:"L"},{value:0,label:"XL"}],e&&i.push({value:0,label:"N/A"}),r&&r.map(e=>[e.captain,e.second]).flat(1).forEach(a=>{if(a)switch(a.bike_size){case"XS":i[0].value++;break;case"S":i[1].value++;break;case"M":i[2].value++;break;case"L":i[3].value++;break;case"XL":i[4].value++;break;default:e&&i[5].value++}}),i),tShirtSizeData:(n=[{value:0,label:"XS"},{value:0,label:"S"},{value:0,label:"M"},{value:0,label:"L"},{value:0,label:"XL"},{value:0,label:"Non"}],r&&r.map(e=>[e.captain,e.second]).flat(1).forEach(e=>{if(e)switch(e.t_shirt_size){case"XS":n[0].value++;break;case"S":n[1].value++;break;case"M":n[2].value++;break;case"L":n[3].value++;break;case"XL":n[4].value++;break;default:n[5].value++}}),n),situationData:(t=[{value:0,label:"Centrale Lyon"},{value:0,label:"Autre \xe9cole"},{value:0,label:"Partenaire"},{value:0,label:"Autre"}],e&&t.push({value:0,label:"N/A"}),r&&r.map(e=>[e.captain,e.second]).flat(1).forEach(a=>{if(a){var l;switch((0,F.l)(null!==(l=a.situation)&&void 0!==l?l:void 0)){case"centrale":t[0].value++;break;case"otherschool":t[1].value++;break;case"corporatepartner":t[2].value++;break;case"other":t[3].value++;break;default:e&&t[4].value++}}}),t)}}(i,a);return(0,s.jsxs)(h.Zb,{children:[(0,s.jsxs)(h.Ol,{className:"flex flex-col items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[(0,s.jsx)(h.ll,{children:"Statistiques"}),(0,s.jsx)(A,{checked:i,onCheckedChange:n})]}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)(h.SZ,{children:i?"Toutes les \xe9quipes":"Equipes valid\xe9es"})})]}),(0,s.jsx)(h.aY,{children:(0,s.jsxs)(P.mQ,{defaultValue:"difficulty",children:[(0,s.jsxs)(P.dr,{className:"grid w-full grid-cols-5 mb-6",children:[(0,s.jsx)(P.SP,{value:"difficulty",children:"Parcours"}),(0,s.jsx)(P.SP,{value:"meetingPlace",children:"D\xe9part"}),(0,s.jsx)(P.SP,{value:"bikeSize",children:"VTT"}),(0,s.jsx)(P.SP,{value:"tShirtSize",children:"T-Shirt"}),(0,s.jsx)(P.SP,{value:"situation",children:"Situation"})]}),(0,s.jsx)(P.nU,{value:"difficulty",children:(0,s.jsx)(z,{data:t})}),(0,s.jsx)(P.nU,{value:"meetingPlace",children:(0,s.jsx)(z,{data:r})}),(0,s.jsx)(P.nU,{value:"bikeSize",children:(0,s.jsx)(z,{data:d})}),(0,s.jsx)(P.nU,{value:"tShirtSize",children:(0,s.jsx)(z,{data:c})}),(0,s.jsx)(P.nU,{value:"situation",children:(0,s.jsx)(z,{data:o})})]})})]})};var U=l(17042),R=l(32897),X=l(39202),Z=l(59805),B=()=>{var e;let{isAdmin:a}=(0,U.a)(),{teams:l,isLoading:t}=(0,R.y)(),{information:r}=(0,Z.u)(),d=(0,x.useRouter)(),c=null==l?void 0:l.filter(e=>null!==e.second),o=null!==(e=null==l?void 0:l.map(e=>[e.captain,e.second]).flat(1).filter(e=>null!==e))&&void 0!==e?e:[],u=null==o?void 0:o.map(e=>e.payment?1:0).reduce((e,a)=>e+a,0),h=null!=r&&!!r.raid_registering_end_date&&(0,X.pc)(null==r?void 0:r.raid_registering_end_date)>=0,m=[{title:"Participants inscrits",value:(null==o?void 0:o.length.toString())||"0",description:"inscriptions d\xe9but\xe9es",unit:void 0},{title:"Bin\xf4mes constitu\xe9s",value:(null==c?void 0:c.length.toString())||"0",description:"".concat((null==o?void 0:o.length)-2*((null==c?void 0:c.length)||0)," participants sans bin\xf4me"),unit:void 0},{title:"Paiements efectu\xe9s",value:(null==u?void 0:u.toString())||"0",description:"".concat((null==o?void 0:o.length)-u," paiements manquants"),unit:void 0},{title:"Equipes valid\xe9es",value:(null==l?void 0:l.filter(e=>100===e.validation_progress).length.toString())||"0",description:"dossiers complets valid\xe9s et pay\xe9s",unit:void 0},{title:"Cloture des inscriptions",value:(null==r?void 0:r.raid_registering_end_date)?(0,X.p6)(null==r?void 0:r.raid_registering_end_date):"Date non renseign\xe9e",description:(null==r?void 0:r.raid_registering_end_date)?h?"".concat((0,X.pc)(null==r?void 0:r.raid_registering_end_date)," jours restants"):"Inscriptions ferm\xe9es":"Date de fin non renseign\xe9e",unit:void 0}];return a()||d.replace("/?redirect=/admin"),(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col",children:[(0,s.jsx)(n.D,{}),(0,s.jsxs)("main",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-3 md:gap-8 lg:grid-cols-5",children:m.map(e=>(0,s.jsx)(i.L,{info:e,isLoaded:!t},e.title))}),(0,s.jsxs)("div",{className:"grid gap-4 md:gap-8 xl:grid-cols-3",children:[(0,s.jsx)(_,{teams:l,isLoading:t}),(0,s.jsx)(q,{teams:l,isLoading:t})]})]})]})}},26477:function(e,a,l){"use strict";l.d(a,{L:function(){return t}});var s=l(57437),i=l(48185),n=l(2183);let t=e=>{let{info:a,isLoaded:l}=e;return(0,s.jsxs)(i.Zb,{children:[(0,s.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(i.ll,{className:"text-sm font-medium",children:l?(0,s.jsx)("span",{children:a.title}):(0,s.jsx)(n.O,{className:"w-24 h-5"})}),a.unit&&(l?a.unit:(0,s.jsx)(n.O,{className:"w-4 h-4 text-muted-foreground"}))]}),(0,s.jsxs)(i.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:l?a.value:(0,s.jsx)(n.O,{className:"w-[150px] h-6"})}),l?(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:a.description}):(0,s.jsx)(n.O,{className:"w-[120px] h-4 mt-1"})]})]},a.title)}},59805:function(e,a,l){"use strict";l.d(a,{u:function(){return n}});var s=l(84980),i=l(40133);let n=()=>{let{token:e,userId:a}=(0,i.a)(),{data:l,isLoading:n,refetch:t}=(0,s.THV)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:null!==a,retry:0,queryHash:"getRaidInformation"}),{mutate:r,isPending:d}=(0,s.Arm)({});return{information:l,isLoading:n,refetchInformation:t,updateInformation:(a,l)=>{r({body:a,headers:{Authorization:"Bearer ".concat(e)}},{onSettled:()=>{t(),l()}})},isUpdateLoading:d}}},77504:function(e,a,l){"use strict";function s(e){return null==e?void 0:e.split(" : ")[0]}function i(e){let a=null==e?void 0:e.split(" : ");return(null==a?void 0:a.length)===2?a[1]:"Centrale"}l.d(a,{Q:function(){return i},l:function(){return s}})}},function(e){e.O(0,[74,422,576,909,443,625,590,795,90,104,971,23,744],function(){return e(e.s=18916)}),_N_E=e.O()}]);