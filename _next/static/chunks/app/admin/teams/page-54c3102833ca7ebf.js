(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[602],{16253:function(e,s,a){Promise.resolve().then(a.bind(a,93179))},93179:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ew}});var l=a(57437),t=a(48185),n=a(2265),i=a(33514),r=a(54175),c=a(4867),d=a(89733),o=a(77209),u=a(37440),m=a(21413),x=a(29973),h=a(79055),p=a(34063);function g(e){let{column:s,title:a,options:t}=e,n=null==s?void 0:s.getFacetedUniqueValues(),i=new Set(null==s?void 0:s.getFilterValue());return(0,l.jsxs)(m.J2,{children:[(0,l.jsx)(m.xo,{asChild:!0,children:(0,l.jsxs)(d.z,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[(0,l.jsx)(c.SPS,{className:"mr-2 h-4 w-4"}),a,(null==i?void 0:i.size)>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.Z,{orientation:"vertical",className:"mx-2 h-4"}),(0,l.jsx)(h.C,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:i.size}),(0,l.jsx)("div",{className:"hidden space-x-1 lg:flex",children:i.size>2?(0,l.jsxs)(h.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[i.size," s\xe9lectionn\xe9s"]}):t.filter(e=>i.has(e.value)).map(e=>(0,l.jsx)(h.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:e.label},e.value))})]})]})}),(0,l.jsx)(m.yk,{className:"w-[200px] p-0",align:"start",children:(0,l.jsxs)(p.mY,{children:[(0,l.jsx)(p.sZ,{placeholder:a}),(0,l.jsxs)(p.e8,{children:[(0,l.jsx)(p.rb,{children:"Aucun r\xe9sultat"}),(0,l.jsx)(p.fu,{children:t.map(e=>{let a=i.has(e.value);return(0,l.jsxs)(p.di,{onSelect:()=>{a?i.delete(e.value):i.add(e.value);let l=Array.from(i);null==s||s.setFilterValue(l.length?l:void 0)},children:[(0,l.jsx)("div",{className:(0,u.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",a?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,l.jsx)(c.nQG,{className:(0,u.cn)("h-4 w-4")})}),e.icon&&(0,l.jsx)(e.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:e.label}),(null==n?void 0:n.get(e.value))&&(0,l.jsx)("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:n.get(e.value)})]},e.value)})}),i.size>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.zz,{}),(0,l.jsx)(p.fu,{children:(0,l.jsx)(p.di,{onSelect:()=>null==s?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Supprimer les filtres"})})]})]})]})})]})}var j=a(79219),v=a(31590);function f(e){let{table:s}=e;return(0,l.jsxs)(v.h_,{children:[(0,l.jsx)(j.$F,{asChild:!0,children:(0,l.jsxs)(d.z,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[(0,l.jsx)(c.hsZ,{className:"mr-2 h-4 w-4"}),"Colonnes"]})}),(0,l.jsxs)(v.AW,{align:"end",className:"w-[180px]",children:[(0,l.jsx)(v.Ju,{children:"Activer les colonnes"}),(0,l.jsx)(v.VD,{}),s.getAllColumns().filter(e=>void 0!==e.accessorFn&&e.getCanHide()).map(e=>(0,l.jsx)(v.bO,{checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),children:function(e){switch(e){case"second":return"Co\xe9quipier";case"captain":return"Capitaine";case"difficulty":return"Parcours";case"meeting_place":return"Lieu de rendez-vous";case"validation_progress":return"Inscription";case"document_progress":return"Documents";default:return e}}(e.id)},e.id))]})]})}var N=a(63967),w=a(44541);function S(e){let{column:s,title:a}=e,t=new Set(null==s?void 0:s.getFilterValue()),n=Array.from(t).length>0,i=()=>{n?t.delete(null):t.add(null);let e=Array.from(t);null==s||s.setFilterValue(e.length?e:void 0)};return(0,l.jsxs)(d.z,{variant:"ghost",className:"h-8 border-dashed border",onClick:i,children:[(0,l.jsx)(w.X,{checked:n,className:"mr-2",onCheckedChange:i}),a]})}var b=a(93191),y=a(84980),C=a(40133),P=a(78068);let _=()=>{let{token:e}=(0,C.a)(),s=(0,b.NL)(),{mutate:a,isPending:l}=(0,y.mzN)({});return{mergeTeams:(l,t,n)=>{a({headers:{Authorization:"Bearer ".concat(e)},queryParams:{team1_id:l,team2_id:t}},{onSuccess(e,a,l){s.invalidateQueries({predicate:e=>"getTeamById"===e.queryHash}),n()},onError(e,s,a){console.log(e),(0,P.Am)({title:"Erreur lors de la fusion des \xe9quipes",description:"Une erreur est survenue, veuillez r\xe9essayer plus tard",variant:"destructive"})}})},isMergeLoading:l}};var k=a(44032),z=a(34554),A=a(10883),F=a(32897),V=a(76072);let q=()=>{let{token:e}=(0,C.a)(),s=(0,b.NL)(),{mutate:a,isPending:l}=(0,y.q7$)({});return{deleteAllTeams:l=>{a({headers:{Authorization:"Bearer ".concat(e)}},{onSettled(){s.invalidateQueries({predicate:e=>"getTeams"===e.queryHash||"getTeamById"===e.queryHash||"getTeamByParticipantId"===e.queryHash}),(0,P.Am)({title:"Succ\xe8s",description:"Toutes les \xe9quipes ont \xe9t\xe9 supprim\xe9es avec succ\xe8s"}),l()},onError(e){console.error(e),(0,P.Am)({title:"Erreur",description:"Une erreur est survenue lors de la suppression des \xe9quipes",variant:"destructive"})}})},isDeleteAllLoading:l}};function D(e){var s,a;let{table:t}=e,{refetchTeams:i}=(0,F.y)(),{mergeTeams:r,isMergeLoading:u}=_(),[m,x]=(0,n.useState)(!1),h=t.getState().columnFilters.length>0,{deleteAllTeams:p,isDeleteAllLoading:j}=q();return(0,l.jsxs)(l.Fragment,{children:[m&&(0,l.jsx)(V.Z,{isOpened:m,setIsOpened:x,isLoading:j,title:"Suppression de toutes les \xe9quipes",description:"\xcates-vous s\xfbr de vouloir supprimer TOUTES les \xe9quipes ? Cette action est irr\xe9versible et supprimera d\xe9finitivement toutes les \xe9quipes existantes.",validateLabel:"Supprimer tout",callback:()=>p(()=>{i(),x(!1)}),width:"w-[150px]"}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-1 items-center space-x-2",children:[(0,l.jsx)(o.I,{placeholder:"Filtrer les \xe9quipes...",value:null!==(a=null===(s=t.getColumn("name"))||void 0===s?void 0:s.getFilterValue())&&void 0!==a?a:"",onChange:e=>{var s;return null===(s=t.getColumn("name"))||void 0===s?void 0:s.setFilterValue(e.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),t.getColumn("difficulty")&&(0,l.jsx)(g,{column:t.getColumn("difficulty"),title:"Parcours",options:N.n9}),t.getColumn("meeting_place")&&(0,l.jsx)(g,{column:t.getColumn("meeting_place"),title:"Lieu de rendez-vous",options:N.xQ}),t.getColumn("second")&&(0,l.jsx)(S,{column:t.getColumn("second"),title:"Equipe sans co\xe9quipier"}),h&&(0,l.jsxs)(d.z,{variant:"ghost",onClick:()=>t.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Supprimer",(0,l.jsx)(c.Pxu,{className:"ml-2 h-4 w-4"})]}),(t.getIsSomeRowsSelected()||t.getIsAllRowsSelected())&&(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)(k.f,{onClick:()=>{let e=Object.keys(t.getState().rowSelection).map(e=>t.getRow(e).original).map(e=>e.id);r(e[0],e[1],()=>{i(),t.resetRowSelection()})},className:"h-8 px-2 lg:px-3 lg:w-[105px] w-[40px]",disabled:2!==Object.keys(t.getState().rowSelection).length,isLoading:u,label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"max-lg:hidden",children:"Fusionner"}),(0,l.jsx)(z.Z,{className:"lg:ml-2 h-4 w-4"})]})}),(0,l.jsxs)(d.z,{variant:"ghost",onClick:()=>{t.resetRowSelection()},className:"ml-2 h-8 px-2 lg:px-3 lg:w-[105px] w-[40px]",children:[(0,l.jsx)("span",{className:"max-lg:hidden",children:"Annuler"}),(0,l.jsx)(c.Pxu,{className:"lg:ml-2 h-4 w-4"})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)(d.z,{onClick:()=>x(!0),variant:"destructive",size:"sm",className:"h-8 px-2 flex items-center",children:[(0,l.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"Supprimer toutes les \xe9quipes"]}),(0,l.jsx)(f,{table:t})]})]})]})}var I=a(2128),R=a(16463);function L(e){let{table:s}=e,a=(0,R.useRouter)(),t=(0,R.useSearchParams)();function n(e){let s=new URLSearchParams(Array.from(t.entries()));s.set("page","".concat(e));let l=s.toString();a.replace("/admin/teams?".concat(l))}return(0,l.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,l.jsxs)("div",{className:"flex-1 text-sm text-muted-foreground",children:[s.getFilteredSelectedRowModel().rows.length," sur"," ",s.getFilteredRowModel().rows.length," \xe9quipe(s) s\xe9l\xe9ctionn\xe9es."]}),(0,l.jsxs)("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Equipes par page"}),(0,l.jsxs)(I.Ph,{value:"".concat(s.getState().pagination.pageSize),onValueChange:e=>{s.setPageSize(Number(e))},children:[(0,l.jsx)(I.i4,{className:"h-8 w-[70px]",children:(0,l.jsx)(I.ki,{placeholder:s.getState().pagination.pageSize})}),(0,l.jsx)(I.Bw,{side:"top",children:[10,25,50,100].map(e=>(0,l.jsx)(I.Ql,{value:"".concat(e),children:e},e))})]})]}),(0,l.jsxs)("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," sur"," ",s.getPageCount()]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)(d.z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>n(0),disabled:!s.getCanPreviousPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,l.jsx)(c.kRt,{className:"h-4 w-4"})]}),(0,l.jsxs)(d.z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>n(s.getState().pagination.pageIndex-1),disabled:!s.getCanPreviousPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,l.jsx)(c.wyc,{className:"h-4 w-4"})]}),(0,l.jsxs)(d.z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>n(s.getState().pagination.pageIndex+1),disabled:!s.getCanNextPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,l.jsx)(c.XCv,{className:"h-4 w-4"})]}),(0,l.jsxs)(d.z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>n(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,l.jsx)(c.yr4,{className:"h-4 w-4"})]})]})]})]})}var O=a(47304);function Q(e){var s;let{columns:a,data:t}=e,[c,d]=n.useState({}),[o,u]=n.useState({}),[m,x]=n.useState([]),[h,p]=n.useState([]),g=(0,R.useRouter)(),j=(0,R.useSearchParams)(),v=(0,i.b7)({data:t,columns:a,state:{sorting:h,columnVisibility:o,rowSelection:c,columnFilters:m},enableRowSelection:!0,onRowSelectionChange:d,onSortingChange:p,onColumnFiltersChange:x,onColumnVisibilityChange:u,getCoreRowModel:(0,r.sC)(),getFilteredRowModel:(0,r.vL)(),getPaginationRowModel:(0,r.G_)(),getSortedRowModel:(0,r.tj)(),getFacetedRowModel:(0,r.o6)(),getFacetedUniqueValues:(0,r.JG)()});return n.useEffect(()=>{let e=new URLSearchParams(Array.from(j.entries())).get("page");if(e){let s=Number(e);s<0?s=0:s>v.getPageCount()&&(s=v.getPageCount()-1),v.setPageIndex(s)}},[j,v]),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(D,{table:v}),(0,l.jsx)("div",{className:"rounded-md border",children:(0,l.jsxs)(O.iA,{children:[(0,l.jsx)(O.xD,{children:v.getHeaderGroups().map(e=>(0,l.jsx)(O.SC,{children:e.headers.map(e=>(0,l.jsx)(O.ss,{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,i.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,l.jsx)(O.RM,{children:(null===(s=v.getRowModel().rows)||void 0===s?void 0:s.length)?v.getRowModel().rows.map(e=>(0,l.jsx)(O.SC,{"data-state":e.getIsSelected()&&"selected",onClick:()=>(function(e){if(v.getIsSomeRowsSelected()||v.getIsAllRowsSelected()){if(e.original.second){(0,P.Am)({title:"S\xe9lection impossible",description:"Impossible de fusionner une \xe9quipe compl\xe8te"});return}e.toggleSelected(!e.getIsSelected());return}let s=e.original.id,a=new URLSearchParams(Array.from(j.entries()));a.set("teamId",s);let l=a.toString();g.replace("/admin/teams?".concat(l))})(e),children:e.getVisibleCells().map(e=>(0,l.jsx)(O.pj,{children:(0,i.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,l.jsx)(O.SC,{children:(0,l.jsx)(O.pj,{colSpan:a.length,className:"h-24 text-center",children:"Pas de r\xe9sultat"})})})]})}),(0,l.jsx)(L,{table:v})]})}function T(e){let{column:s,title:a,className:t}=e;return s.getCanSort()?(0,l.jsx)("div",{className:(0,u.cn)("flex items-center space-x-2",t),children:(0,l.jsxs)(v.h_,{children:[(0,l.jsx)(v.$F,{asChild:!0,children:(0,l.jsxs)(d.z,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent -mr-7",children:[(0,l.jsx)("span",{children:a}),"desc"===s.getIsSorted()?(0,l.jsx)(c.veu,{className:"ml-2 h-4 w-4"}):"asc"===s.getIsSorted()?(0,l.jsx)(c.Hf3,{className:"ml-2 h-4 w-4"}):(0,l.jsx)(c.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsxs)(v.AW,{align:"start",children:[(0,l.jsxs)(v.Xi,{onClick:()=>s.toggleSorting(!1),children:[(0,l.jsx)(c.Hf3,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),(0,l.jsxs)(v.Xi,{onClick:()=>s.toggleSorting(!0),children:[(0,l.jsx)(c.veu,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),(0,l.jsx)(v.VD,{}),(0,l.jsxs)(v.Xi,{onClick:()=>s.toggleVisibility(!1),children:[(0,l.jsx)(c.L52,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Cacher"]})]})]})}):(0,l.jsx)("div",{className:(0,u.cn)(t),children:a})}var Z=a(54008),E=a(72208),U=a(17042);let B=e=>{let{token:s,userId:a,isTokenExpired:l}=(0,C.a)(),{isAdmin:t}=(0,U.a)(),n=(0,b.NL)(),{data:i,refetch:r}=(0,y.nzy)({headers:{Authorization:"Bearer ".concat(s)},pathParams:{teamId:e}},{enabled:null!==a&&t()&&!l(),retry:0,queryHash:"getTeamById"}),{mutate:c,isPending:d}=(0,y.RM4)({}),{mutate:o,isPending:u}=(0,y.Uqw)({});return{team:i,refetchTeam:r,kickMember:(a,l)=>{c({headers:{Authorization:"Bearer ".concat(s)},pathParams:{teamId:e,participantId:a}},{onSuccess(e,s,a){n.invalidateQueries({predicate:e=>"getTeamById"===e.queryHash}),l()},onError(e,s,a){console.log(e),(0,P.Am)({title:"Erreur lors de l'exclusion du membre",description:"Une erreur est survenue, veuillez r\xe9essayer plus tard",variant:"destructive"})}})},isKickLoading:d,isDeleteLoading:u,deleteTeam:a=>{o({headers:{Authorization:"Bearer ".concat(s)},pathParams:{teamId:e}},{onSettled(){n.invalidateQueries({predicate:e=>"getTeamById"===e.queryHash}),a()}})}}};var M=a(13304),H=a(54662);let K=(e,s,a)=>(0,l.jsx)(t.Zb,{className:s===e?"border-2 border-primary ":"my-[1px]",onClick:()=>a(e),children:(0,l.jsxs)(t.aY,{className:"flex flex-col justify-between items-center",children:[(0,l.jsx)("div",{className:"h-5"}),(0,l.jsxs)("p",{className:"text-lg font-semibold",children:[e.firstname," ",e.name]}),(0,l.jsx)("p",{className:"text-sm text-foreground-muted",children:e.email})]})}),Y=e=>{let{isOpened:s,setIsOpened:a,isLoading:t,title:i,team:r,validateLabel:c,callback:o}=e,[u,m]=(0,n.useState)(null);return(0,l.jsx)(H.Vq,{open:s,onOpenChange:a,children:(0,l.jsxs)(H.cZ,{className:"sm:max-w-[600px]",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)(H.fK,{children:(0,l.jsx)(H.$N,{children:i})}),(0,l.jsx)(M.Be,{children:(0,l.jsxs)("div",{className:"grid gap-4 grid-cols-2 mt-2",children:[r.captain&&K(r.captain,u,m),r.second&&K(r.second,u,m)]})}),(0,l.jsxs)("div",{className:"flex justify-end mt-2 space-x-4",children:[(0,l.jsx)(d.z,{variant:"outline",onClick:function(e){e.stopPropagation(),a(!1)},disabled:t,className:"w-[100px]",children:"Annuler"}),(0,l.jsx)(k.f,{isLoading:t,onClick:function(e){e.stopPropagation(),u&&o(null==u?void 0:u.id)},label:c,className:"w-[100px]",disabled:!u})]})]})})};function G(e){let{row:s}=e,{deleteTeam:a,isDeleteLoading:t,kickMember:i,isKickLoading:r,refetchTeam:o}=B(s.original.id),{refetchTeams:u}=(0,F.y)(),[m,x]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[m&&(0,l.jsx)(V.Z,{isOpened:m,setIsOpened:x,isLoading:t,title:"Suppression de l'\xe9quipe ".concat(s.original.name),description:"Etes-vous s\xfbr de vouloir supprimer cette \xe9quipe ?",validateLabel:"Supprimer",callback:()=>{a(()=>{o(),u(),x(!1)})}}),h&&(0,l.jsx)(Y,{isOpened:h,setIsOpened:p,isLoading:r,title:"Retirer un membre de l'\xe9quipe ".concat(s.original.name),team:s.original,validateLabel:"Retirer",callback:e=>{i(e,()=>{o(),u(),p(!1)})}}),(0,l.jsxs)(v.h_,{children:[(0,l.jsx)(v.$F,{asChild:!0,children:(0,l.jsxs)(d.z,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[(0,l.jsx)(c.nWS,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,l.jsxs)(v.AW,{align:"end",className:"w-[180px]",children:[null===s.getValue("second")?(0,l.jsxs)(v.Xi,{onClick:e=>{e.stopPropagation(),s.toggleSelected(!s.getIsSelected())},children:[s.getIsSelected()?"Annuler la fusion":"Fusionner avec une autre \xe9quipe",(0,l.jsx)(v.KM,{children:(0,l.jsx)(z.Z,{className:"h-4 w-4"})})]}):(0,l.jsxs)(v.Xi,{onClick:e=>{e.stopPropagation(),p(!0)},children:["Retirer un member",(0,l.jsx)(v.KM,{children:(0,l.jsx)(E.Z,{className:"h-4 w-4"})})]}),(0,l.jsx)(v.VD,{}),(0,l.jsxs)(v.Xi,{className:"text-destructive",onClick:e=>{e.stopPropagation(),x(!0)},children:["Supprimer l'\xe9quipe",(0,l.jsx)(v.KM,{children:(0,l.jsx)(Z._YF,{className:"h-4 w-4"})})]})]})]})]})}var X=a(26142);let J=[{accessorKey:"name",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Equipe"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{children:s.getValue("name")})},enableSorting:!1,enableHiding:!1},{accessorKey:"captain",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Capitaine"})},cell:e=>{let{row:s}=e,a=s.getValue("captain");return(0,l.jsxs)("div",{className:"flex space-x-2",children:[a.firstname," ",a.name]})},enableSorting:!1},{accessorKey:"second",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Co\xe9quiper"})},cell:e=>{let{row:s}=e,a=s.getValue("second");return(0,l.jsx)("div",{className:"flex space-x-2 ".concat(null!=a?a:"text-muted-foreground"),children:a?"".concat(a.firstname," ").concat(a.name):"Non renseign\xe9"})},enableSorting:!1,filterFn:(e,s,a)=>a.includes(e.getValue(s))},{accessorKey:"difficulty",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Parcours",className:"max-lg:hidden"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{className:"flex space-x-2 max-lg:hidden",children:(0,l.jsx)(h.C,{variant:"outline",children:(0,N.Jg)(N.n9,s.getValue("difficulty"))})})},filterFn:(e,s,a)=>a.includes(e.getValue(s))},{accessorKey:"meeting_place",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Lieu de rendez-vous",className:"max-lg:hidden"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{className:"flex space-x-2 max-lg:hidden",children:(0,l.jsx)(h.C,{variant:"outline",children:(0,N.Jg)(N.xQ,s.getValue("meeting_place"))})})},filterFn:(e,s,a)=>a.includes(e.getValue(s))},{accessorKey:"validation_progress",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Inscription",className:""})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{className:"flex space-x-2 items-center",children:(0,l.jsxs)("span",{children:[s.getValue("validation_progress").toFixed(0),"%"]})})},sortingFn:(e,s,a)=>e.getValue(a)-s.getValue(a)},{accessorKey:"document_progress",header:e=>{let{column:s}=e;return(0,l.jsx)(T,{column:s,title:"Documents"})},cell:e=>{var s,a,t,n;let{row:i}=e,r=i.getValue("captain").number_of_validated_document+(null!==(t=null===(s=i.getValue("second"))||void 0===s?void 0:s.number_of_validated_document)&&void 0!==t?t:0),c=i.getValue("captain").number_of_document+(null!==(n=null===(a=i.getValue("second"))||void 0===a?void 0:a.number_of_document)&&void 0!==n?n:0);return(0,l.jsx)(X.r,{progress:r,total:c})},enableSorting:!1},{id:"actions",cell:e=>{let{row:s}=e;return(0,l.jsx)(G,{row:s})}}];var $=a(85115),W=a(55936),ee=a(86864),es=a(67935),ea=a(77504),el=a(39202);let et=e=>{let{participant:s}=e;return(0,l.jsxs)(t.Zb,{children:[(0,l.jsxs)(t.Ol,{children:[(0,l.jsx)(t.ll,{children:s.firstname+" "+s.name}),(0,l.jsxs)(t.SZ,{children:["dossier particiant complet\xe9 \xe0"," ",s.validation_progress.toFixed(0),"%"]})]}),(0,l.jsxs)(t.aY,{children:[(0,l.jsx)(es.Q,{label:"Date de naissance",value:(0,el.p6)(s.birthday)}),(0,l.jsx)(es.Q,{label:"Email",value:s.email}),(0,l.jsx)(es.Q,{label:"Adresse",value:s.address}),(0,l.jsx)(es.Q,{label:"Taille de v\xe9lo",value:s.bike_size}),(0,l.jsx)(es.Q,{label:"Taille de t-shirt",value:s.t_shirt_size}),(0,l.jsx)(es.Q,{label:"R\xe9gime alimentaire",value:s.diet}),function(e){var s,a;let t=(0,ea.l)(null!==(s=e.situation)&&void 0!==s?s:void 0),n=(0,ea.Q)(null!==(a=e.situation)&&void 0!==a?a:void 0);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(es.Q,{label:"Situation",value:(0,N.Jg)(N.LN,t)}),"otherschool"===t&&(0,l.jsx)(es.Q,{label:"Nom de l'\xe9cole",value:n}),"corporatepartner"===t&&(0,l.jsx)(es.Q,{label:"Nom de l'entreprise",value:n}),"other"===t&&(0,l.jsx)(es.Q,{label:"Autre situation",value:n})]})}(s),(0,l.jsx)(es.Q,{label:"Attestation sur l'honneur",value:s.attestation_on_honour})]})]})},en=e=>{let{team:s}=e;return(0,l.jsxs)("div",{className:"grid xl:grid-cols-2 gap-4 w-full py-6 grid-cols-1 max-md:p-8 max-md:gap-4",children:[(0,l.jsx)(et,{participant:s.captain}),s.second?(0,l.jsx)(et,{participant:s.second}):(0,l.jsx)(t.Zb,{className:"w-full h-full",children:(0,l.jsx)(t.aY,{className:"w-full h-full mt-3",children:(0,l.jsx)("span",{className:"flex m-auto h-full justify-center items-center text-muted-foreground",children:"Aucun co\xe9quipier n'a \xe9t\xe9 ajout\xe9 \xe0 cette \xe9quipe."})})})]})};var ei=a(2183),er=a(35265),ec=a(18189),ed=a(40933);let eo=e=>{let{validateDocument:s,label:a}=e,[t,i]=(0,n.useState)(!1);return(0,l.jsx)(k.f,{isLoading:t,label:a,className:"w-full",onClick:e=>{i(!0),s(()=>{i(!1)})}})},eu=e=>{let{value:s,document:a,index:t,setDocument:n,downloadDocument:i,validateDocument:r}=e,c=a&&"accepted"===a.validation||!1,o=a&&"refused"===a.validation||!1,u=a&&"temporary"===a.validation||!1,m=a&&"pending"===a.validation||!1;return(0,l.jsxs)(er.Qd,{value:"item-".concat(t),onClick:()=>{a&&n(a)},children:[(0,l.jsx)(er.o4,{children:(0,l.jsxs)("div",{className:"flex flex-row mr-auto items-center",children:[c&&(0,l.jsx)(Z.dZ6,{className:"mr-4"}),o&&(0,l.jsx)(Z.apv,{className:"mr-4"}),u&&(0,l.jsx)(ec.Z,{className:"mr-4 h-4 w-4"}),m&&(0,l.jsx)(ed.Z,{className:"mr-4 h-4 w-4"}),s]})}),(0,l.jsx)(er.vF,{children:a?(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex grid-cols-2 gap-4",children:[!c&&(0,l.jsx)(eo,{label:"Valider",validateDocument:e=>{r(a.id,"accepted",e)}}),!c&&!u&&"medicalCertificate"===a.type&&(0,l.jsx)(eo,{label:"Valider temporairement",validateDocument:e=>{r(a.id,"temporary",e)}}),!o&&(0,l.jsx)(eo,{label:"Refuser",validateDocument:e=>{r(a.id,"refused",e)}})]}),(0,l.jsxs)(d.z,{variant:"outline",className:"w-full",onClick:e=>i(a),children:[(0,l.jsx)(Z.H_7,{className:"mr-2"}),"T\xe9l\xe9charger"]})]}):(0,l.jsx)("span",{className:"text-muted-foreground",children:"Aucun document"})})]})},em=e=>{var s,a,n,i,r;let{participant:c,setDocument:d,downloadDocument:o,validateDocument:u,isValidationLoading:m}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.Ol,{children:(0,l.jsxs)(t.ll,{children:[c.firstname," ",c.name]})}),(0,l.jsx)(t.aY,{children:(0,l.jsxs)(er.UQ,{type:"single",collapsible:!0,className:"w-full",children:[(0,l.jsx)(eu,{value:"Carte d'identit\xe9",document:c.id_card,index:0,setDocument:d,downloadDocument:o,validateDocument:u}),(0,l.jsx)(eu,{value:"Certificat m\xe9dical",document:c.medical_certificate,index:1,setDocument:d,downloadDocument:o,validateDocument:u}),(0,l.jsx)(eu,{value:"R\xe9glement",document:null!==(s=c.raid_rules)&&void 0!==s?s:null,index:2,setDocument:d,downloadDocument:o,validateDocument:u}),["centrale","otherschool"].includes(null!==(n=(0,ea.l)(null!==(a=c.situation)&&void 0!==a?a:void 0))&&void 0!==n?n:"")&&(0,l.jsx)(eu,{value:"Carte \xe9tudiante",document:null!==(i=c.student_card)&&void 0!==i?i:null,index:3,setDocument:d,downloadDocument:o,validateDocument:u}),c.is_minor&&(0,l.jsx)(eu,{value:"Autorisation parentale",document:null!==(r=c.parent_authorization)&&void 0!==r?r:null,index:4,setDocument:d,downloadDocument:o,validateDocument:u})]})})]})};var ex=a(36645),eh=a(90174);let ep=e=>{let{team:s}=e,{getDocument:a,setDocumentValidation:i,isValidationLoading:r}=(0,eh.k)(),{refetchTeam:c}=B(s.id),{refetchTeams:d}=(0,F.y)(),[o,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(null);function h(e,s){let l=e.type,t=a(s.id,l);if(void 0!==t){let e=t.type.split("/")[1],a="".concat(s.firstname,"_").concat(s.name,"_").concat(l,".").concat(e),n=window.URL.createObjectURL(new Blob([t])),i=document.createElement("a");i.href=n,i.setAttribute("download",a),document.body.appendChild(i),i.click()}}function p(e,s,a){i(e,s,()=>{c(),d(),a(),(0,P.Am)({title:"Document valid\xe9 avec succ\xe8s"})})}let g=null==o?void 0:o.type;return(0,l.jsxs)("div",{className:"grid xl:grid-cols-2 gap-4 w-full py-6 grid-cols-1 max-md:p-8 max-md:gap-4",children:[(0,l.jsxs)(t.Zb,{children:[(0,l.jsx)(em,{participant:s.captain,setDocument:e=>{var a;return a=s.captain.id,void(u(e),x(a))},downloadDocument:e=>h(e,s.captain),validateDocument:p,isValidationLoading:r}),s.second&&(0,l.jsx)(em,{participant:s.second,setDocument:e=>{var a;return a=s.second.id,void(u(e),x(a))},downloadDocument:e=>h(e,s.second),validateDocument:p,isValidationLoading:r})]}),o&&g&&m&&(0,l.jsx)(ex.s,{userId:m,documentKey:g,id:o.id,file:a(m,g),width:450})]})},eg=e=>{let{participant:s,validateCallback:a,validateTShirtCallback:i}=e,[r,c]=(0,n.useState)(!1),[d,o]=(0,n.useState)(!1);return(0,l.jsxs)(t.Zb,{children:[(0,l.jsx)(t.Ol,{children:(0,l.jsxs)(t.ll,{children:[s.firstname," ",s.name]})}),(0,l.jsx)(t.aY,{children:(0,l.jsxs)("div",{className:"flex space-x-4",children:[s.payment?(0,l.jsx)("p",{className:"w-full",children:"L'inscription \xe0 \xe9t\xe9 pay\xe9e"}):(0,l.jsx)(k.f,{onClick:e=>{c(!0),a(s.id,()=>{c(!1)})},isLoading:r,label:"Valider le paiement de l'inscription",className:"w-full"}),s.t_shirt_size&&(0,l.jsx)(l.Fragment,{children:s.t_shirt_payment?(0,l.jsx)("p",{className:"w-full",children:"Le T-Shirt \xe0 \xe9t\xe9 pay\xe9e"}):(0,l.jsx)(k.f,{onClick:e=>{o(!0),i(s.id,()=>{o(!1)})},isLoading:d,label:"Valider le paiement du T-Shirt",className:"w-full"})})]})})]})},ej=()=>{let{token:e}=(0,C.a)(),{mutate:s,isPending:a}=(0,y.NmN)(),{mutate:l,isPending:t}=(0,y.rHE)();return{validatePayment:(a,l)=>{s({headers:{Authorization:"Bearer ".concat(e)},pathParams:{participantId:a}},{onSettled:()=>{l()}})},isPaymentLoading:a,validateTShirtPayment:(s,a)=>{l({headers:{Authorization:"Bearer ".concat(e)},pathParams:{participantId:s}},{onSettled:()=>{a()}})},isTshirtPaymentLoading:t}},ev=e=>{let{team:s}=e,{validatePayment:a,validateTShirtPayment:n}=ej(),{refetchTeam:i}=B(s.id),{refetchTeams:r}=(0,F.y)();function c(e,s){a(e,()=>{s(),i(),r(),(0,P.Am)({title:"Paiement valid\xe9 avec succ\xe8s"})})}function d(e,s){n(e,()=>{s(),i(),r(),(0,P.Am)({title:"Paiement du T-Shirt valid\xe9 avec succ\xe8s"})})}return(0,l.jsxs)("div",{className:"grid xl:grid-cols-2 gap-4 w-full py-6 grid-cols-1 max-md:p-8 max-md:gap-4",children:[(0,l.jsx)(eg,{participant:s.captain,validateCallback:c,validateTShirtCallback:d}),s.second?(0,l.jsx)(eg,{participant:s.second,validateCallback:c,validateTShirtCallback:d}):(0,l.jsx)(t.Zb,{className:"w-full h-full",children:(0,l.jsx)(t.aY,{className:"w-full h-full mt-3",children:(0,l.jsx)("span",{className:"flex m-auto h-full justify-center items-center text-muted-foreground",children:"Aucun co\xe9quipier n'a \xe9t\xe9 ajout\xe9 \xe0 cette \xe9quipe."})})})]})};var ef=a(80023);let eN=e=>{let{isOpened:s,onClose:a,teamId:t}=e,{team:n}=B(t),i=(null==n?void 0:n.id)!==t;return(0,l.jsx)(W.yo,{open:s,onOpenChange:a,children:(0,l.jsxs)(W.ue,{side:"team",children:[(0,l.jsx)(W.Tu,{children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ei.O,{className:"h-8 w-32"}),(0,l.jsx)(ei.O,{className:"h-4 w-80"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W.bC,{children:null==n?void 0:n.name}),(0,l.jsxs)(W.Ei,{children:["Dossier \xe9quipe complet\xe9 \xe0 ",null==n?void 0:n.validation_progress.toFixed(0)," ","%"]})]})}),(0,l.jsx)("div",{className:"p-4"}),(0,l.jsxs)(ee.mQ,{defaultValue:"information",className:"",children:[(0,l.jsxs)(ee.dr,{className:"grid grid-cols-3 w-[500px]",children:[(0,l.jsx)(ee.SP,{value:"information",children:"Informations"}),(0,l.jsx)(ee.SP,{value:"document",children:"Documents"}),(0,l.jsx)(ee.SP,{value:"payment",children:"Paiement"})]}),i?(0,l.jsx)(ei.O,{className:"h-96 w-192 mt-6"}):(0,l.jsxs)(ef.x,{className:"h-[calc(100vh-180px)] w-full mt-4",children:[(0,l.jsx)(ee.nU,{value:"information",className:"mt-0",children:n&&(0,l.jsx)(en,{team:n})}),(0,l.jsx)(ee.nU,{value:"document",className:"mt-0",children:n&&(0,l.jsx)(ep,{team:n})}),(0,l.jsx)(ee.nU,{value:"payment",className:"mt-0",children:n&&(0,l.jsx)(ev,{team:n})})]})]})]})})};var ew=()=>{let{isAdmin:e}=(0,U.a)(),{teams:s}=(0,F.y)(),a=(0,R.useRouter)(),i=(0,R.useSearchParams)(),[r,c]=(0,n.useState)(!1),[d,o]=(0,n.useState)(null);if(!e()){let e=new URL(window.location.href),s=e.pathname+e.search;a.replace("/?redirect=".concat(s))}let u=i.get("teamId");return u!==d&&(o(u),c(!!u)),(0,l.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-muted/40",children:[(0,l.jsx)($.D,{}),(0,l.jsx)("main",{className:"grid flex-1 items-start gap-4 p-4 sm:px-6 sm:py-0 md:gap-8 mt-8",children:(0,l.jsxs)(t.Zb,{children:[(0,l.jsxs)(t.Ol,{children:[(0,l.jsx)(t.ll,{children:"Equipes"}),(0,l.jsx)(t.SZ,{children:"Liste des \xe9quipes enregistr\xe9es"})]}),(0,l.jsx)(t.aY,{children:s&&(0,l.jsx)(Q,{data:s,columns:J})})]})}),d&&(0,l.jsx)(eN,{isOpened:r,onClose:function(){c(!1);let e=new URLSearchParams(Array.from(i.entries()));e.delete("teamId");let s=e.toString();a.replace("/admin/teams?".concat(s)),o(null)},teamId:d})]})}}},function(e){e.O(0,[74,310,422,651,576,909,443,625,128,107,590,415,90,317,870,104,971,23,744],function(){return e(e.s=16253)}),_N_E=e.O()}]);